{% extends "base.html" %}

{% block content %}
<main>
    <article class="article">
        <h1 class="article-title">{{ page.title }}</h1>

        <div class="article-meta">
            <a href="/about" class="author-img"></a>
            <a href="/about" class="author-name">Madhava</a>
            <span class="article-date">{{ page.date | date(format="%b %d, %Y") }}</span>
        </div>

        {% if page.extra is defined and page.extra.thumbnail is defined and page.extra.thumbnail != "" %}
        {% set thumb_path = page.extra.thumbnail %}
        {% set thumb_base = thumb_path %}
        {% if thumb_base is ending_with('.jpeg') %}
            {% set thumb_base = thumb_base | replace(from='.jpeg', to='') %}
        {% elif thumb_base is ending_with('.jpg') %}
            {% set thumb_base = thumb_base | replace(from='.jpg', to='') %}
        {% elif thumb_base is ending_with('.png') %}
            {% set thumb_base = thumb_base | replace(from='.png', to='') %}
        {% elif thumb_base is ending_with('.avif') %}
            {% set thumb_base = thumb_base | replace(from='.avif', to='') %}
        {% endif %}
        {% set thumb_320 = get_url(path=thumb_base ~ "-320.avif") %}
        {% set thumb_640 = get_url(path=thumb_base ~ "-640.avif") %}
        {% set thumb_1280 = get_url(path=thumb_base ~ "-1280.avif") %}
        {% set thumb_fallback = get_url(path=thumb_path) %}
        <figure class="article-hero">
            <picture>
                <source srcset="{{ thumb_320 | safe }}" media="(max-width: 480px)" type="image/avif">
                <source srcset="{{ thumb_640 | safe }}" media="(max-width: 1024px)" type="image/avif">
                <source srcset="{{ thumb_1280 | safe }}" media="(min-width: 1025px)" type="image/avif">
                <img src="{{ thumb_fallback | safe }}" alt="{{ page.title | default(value='Article featured image') }}"
                    style="width: 100%; height: auto;" fetchpriority="high" decoding="async">
            </picture>
        </figure>
        {% endif %}

        <div class="article-content">
            {{ page.content | safe }}
        </div>

        <div class="article-footer">
            <div class="social-share">
                <span class="share-label">Share:</span>
                <div class="social-icons">
                    <a href="https://twitter.com/intent/tweet?text={{ page.title | urlencode }}&url={{ page.permalink | safe }}"
                        target="_blank" rel="noopener noreferrer" class="social-icon twitter-icon"
                        title="Share on Twitter/X">
                        𝕏
                    </a>
                    <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ page.permalink | safe }}"
                        target="_blank" rel="noopener noreferrer" class="social-icon linkedin-icon"
                        title="Share on LinkedIn">
                        in
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u={{ page.permalink | safe }}" target="_blank"
                        rel="noopener noreferrer" class="social-icon facebook-icon" title="Share on Facebook">
                        f
                    </a>
                    <a href="mailto:?subject={{ page.title | urlencode }}&body=Check out this article: {{ page.permalink | safe }}"
                        class="social-icon email-icon" title="Share via Email">
                        ✉
                    </a>
                    <a href="#"
                        onclick="navigator.clipboard.writeText('{{ page.permalink | safe }}'); alert('Link copied to clipboard!');"
                        class="social-icon copy-icon" title="Copy link">
                        🔗
                    </a>
                </div>
            </div>
        </div>
    </article>
</main>
{% endblock content %}
